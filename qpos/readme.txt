v2: segment size is defined as spatial dimension, with segment size control
also added incremental segmentation
